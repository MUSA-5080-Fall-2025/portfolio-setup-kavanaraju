"0","#| fig-width: 18"
"0","#| fig-height: 14"
"0",""
"0","# Extract coordinates for density plots"
"0","burg_coords   <- data.frame(st_coordinates(burglaries))"
"0","lights_coords <- data.frame(st_coordinates(street_lights))"
"0",""
"0","# Burglary point map"
"0","p1 <- ggplot() + "
"0","  geom_sf(data = chicagoBoundary, fill = ""gray95"", color = ""gray60"") +"
"0","  geom_sf(data = burglaries, color = ""#d62828"", size = 0.1, alpha = 0.4) +"
"0","  labs("
"0","    title = ""Burglary Locations"","
"0","    subtitle = paste0(""Chicago 2017, n = "", nrow(burglaries))"
"0","  )"
"0",""
"0","# Burglary density surface"
"0","p2 <- ggplot() + "
"0","  geom_sf(data = chicagoBoundary, fill = ""gray95"", color = ""gray60"") +"
"0","  geom_density_2d_filled("
"0","    data = burg_coords,"
"0","    aes(X, Y),"
"0","    alpha = 0.7,"
"0","    bins = 8"
"0","  ) +"
"0","  scale_fill_viridis_d("
"0","    option = ""plasma"","
"0","    direction = -1,"
"0","    guide = ""none"""
"0","  ) +"
"0","  labs("
"0","    title = ""Burglary Density Surface"","
"0","    subtitle = ""Kernel density estimation"""
"0","  )"
"0",""
"0","# Street light complaint point map"
"0","p3 <- ggplot() + "
"0","  geom_sf(data = chicagoBoundary, fill = ""gray95"", color = ""gray60"") +"
"0","  geom_sf(data = street_lights, color = ""#3b528b"", size = 0.1, alpha = 0.4) +"
"0","  labs("
"0","    title = ""Street Light Out 311 Requests"","
"0","    subtitle = paste0(""Chicago 2017, n = "", nrow(street_lights))"
"0","  )"
"0",""
"0","# Street light density surface"
"0","p4 <- ggplot() + "
"0","  geom_sf(data = chicagoBoundary, fill = ""gray95"", color = ""gray60"") +"
"0","  geom_density_2d_filled("
"0","    data = lights_coords,"
"0","    aes(X, Y),"
"0","    alpha = 0.7,"
"0","    bins = 8"
"0","  ) +"
"0","  scale_fill_viridis_d("
"0","    option = ""plasma"","
"0","    direction = -1,"
"0","    guide = ""none"""
"0","  ) +"
"0","  labs("
"0","    title = ""Street Light Out Density Surface"","
"0","    subtitle = ""Kernel density estimation"""
"0","  )"
"0",""
"0","(p1 + p2) / (p3 + p4) + "
"0","  plot_annotation("
"0","    title = ""Spatial Distribution of Burglaries and Street Light Out Complaints in Chicago"","
"0","    tag_levels = 'A'"
"0","  )"
